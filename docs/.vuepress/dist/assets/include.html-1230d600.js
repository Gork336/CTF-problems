import{_ as n,o as s,c as a,e as t}from"./app-bd32c210.js";const e={},p=t(`<p>#php #PHP 伪协议</p><p>传入一个 file 试试 ?file=1(值随便)</p><div class="language-php line-numbers-mode" data-ext="php"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
	<span class="token function">ini_set</span><span class="token punctuation">(</span><span class="token string double-quoted-string">&quot;allow_url_include&quot;</span><span class="token punctuation">,</span><span class="token string double-quoted-string">&quot;on&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">header</span><span class="token punctuation">(</span><span class="token string double-quoted-string">&quot;Content-type: text/html; charset=utf-8&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token variable">$file</span><span class="token operator">=</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">&#39;file&#39;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
	<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>    
		<span class="token function">show_source</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>       
		<span class="token keyword">echo</span> <span class="token string single-quoted-string">&#39;flag 在flag.php中&#39;</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span><span class="token keyword">else</span><span class="token punctuation">{</span>       
		<span class="token keyword">echo</span> <span class="token string double-quoted-string">&quot;传入一个file试试&quot;</span><span class="token punctuation">;</span>   <span class="token punctuation">}</span>
	<span class="token keyword">echo</span> <span class="token string double-quoted-string">&quot;&lt;/br&gt;&quot;</span><span class="token punctuation">;</span>
	<span class="token keyword">echo</span> <span class="token string double-quoted-string">&quot;&lt;/br&gt;&quot;</span><span class="token punctuation">;</span>
	<span class="token keyword">echo</span> <span class="token string double-quoted-string">&quot;&lt;/br&gt;&quot;</span><span class="token punctuation">;</span>
	<span class="token keyword">echo</span> <span class="token string double-quoted-string">&quot;&lt;/br&gt;&quot;</span><span class="token punctuation">;</span>
	<span class="token keyword">echo</span> <span class="token string double-quoted-string">&quot;&lt;/br&gt;&quot;</span><span class="token punctuation">;</span>
	<span class="token keyword">include_once</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token delimiter important">?&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>发现有 include_once 函数；<br> include_once()：在脚本执行期间包含并运行指定文件。该函数和 include 函数类似，两者唯一的区别是 使用该函数的时候，php 会加检查指定文件是否已经被包含过，如果是，则不会再被包含。</p><p>于是利用伪协议构造，</p><div class="language-url line-numbers-mode" data-ext="url"><pre class="language-url"><code><span class="token scheme">php<span class="token scheme-delimiter">:</span></span><span class="token authority"><span class="token authority-delimiter">//</span><span class="token host">filter</span></span><span class="token path"><span class="token path-separator">/</span>convert.base64-encode<span class="token path-separator">/</span>resource=flag.php</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>然后解密 base64</p>`,7),o=[p];function l(c,i){return s(),a("div",null,o)}const r=n(e,[["render",l],["__file","include.html.vue"]]);export{r as default};
