import{_ as t,r as p,o as e,c as o,a as n,b as s,d as l,e as c}from"./app-855cd45a.js";const i={},u=c(`<p>#PHP</p><div class="language-php line-numbers-mode" data-ext="php"><pre class="language-php"><code><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">&#39;mode&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">highlight_file</span><span class="token punctuation">(</span>__file__<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">&#39;mode&#39;</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string double-quoted-string">&quot;eval&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token variable">$shell</span> <span class="token operator">=</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">&#39;shell&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">&#39;shell&#39;</span><span class="token punctuation">]</span> <span class="token punctuation">:</span> <span class="token string single-quoted-string">&#39;phpinfo();&#39;</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$shell</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">15</span> <span class="token operator">|</span> <span class="token class-name">filter</span><span class="token punctuation">(</span><span class="token variable">$shell</span><span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token class-name">checkNums</span><span class="token punctuation">(</span><span class="token variable">$shell</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">exit</span><span class="token punctuation">(</span><span class="token string double-quoted-string">&quot;hacker&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$shell</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>


<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">&#39;file&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">&#39;file&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&gt;</span> <span class="token number">15</span> <span class="token operator">|</span> <span class="token class-name">filter</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">&#39;file&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">exit</span><span class="token punctuation">(</span><span class="token string double-quoted-string">&quot;hacker&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">include</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">&#39;file&#39;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>


<span class="token keyword">function</span> <span class="token function-definition function">filter</span><span class="token punctuation">(</span><span class="token variable">$var</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token variable">$banned</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string double-quoted-string">&quot;while&quot;</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">&quot;for&quot;</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">&quot;\\$_&quot;</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">&quot;include&quot;</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">&quot;env&quot;</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">&quot;require&quot;</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">&quot;?&quot;</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">&quot;:&quot;</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">&quot;^&quot;</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">&quot;+&quot;</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">&quot;-&quot;</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">&quot;%&quot;</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">&quot;*&quot;</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">&quot;\`&quot;</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token variable">$banned</span> <span class="token keyword">as</span> <span class="token variable">$ban</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">strstr</span><span class="token punctuation">(</span><span class="token variable">$var</span><span class="token punctuation">,</span> <span class="token variable">$ban</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token constant boolean">True</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">return</span> <span class="token constant boolean">False</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function-definition function">checkNums</span><span class="token punctuation">(</span><span class="token variable">$var</span><span class="token punctuation">)</span>
<span class="token punctuation">{</span>
    <span class="token variable">$alphanum</span> <span class="token operator">=</span> <span class="token string single-quoted-string">&#39;abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ&#39;</span><span class="token punctuation">;</span>
    <span class="token variable">$cnt</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token variable">$i</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token variable">$i</span> <span class="token operator">&lt;</span> <span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$alphanum</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token variable">$i</span><span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token variable">$j</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token variable">$j</span> <span class="token operator">&lt;</span> <span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$var</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token variable">$j</span><span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$var</span><span class="token punctuation">[</span><span class="token variable">$j</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token variable">$alphanum</span><span class="token punctuation">[</span><span class="token variable">$i</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token variable">$cnt</span> <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$cnt</span> <span class="token operator">&gt;</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token constant boolean">True</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token constant boolean">False</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</span></code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-url line-numbers-mode" data-ext="url"><pre class="language-url"><code><span class="token query"><span class="token query-delimiter">?</span><span class="token pair"><span class="token key">mode</span>=<span class="token value">eval</span></span><span class="token pair-delimiter">&amp;</span><span class="token pair"><span class="token key">shell</span>=<span class="token value">system(&#39;ls</span></span></span> /&#39;);
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>发现 nssctfasdasdflag</p><h4 id="本题考点" tabindex="-1"><a class="header-anchor" href="#本题考点" aria-hidden="true">#</a> 本题考点</h4><ol><li>利用 session.upload_progress 进行文件包含</li><li>条件竞争</li></ol>`,6),k={href:"https://blog.csdn.net/qq_46266259/article/details/128867195",target:"_blank",rel:"noopener noreferrer"},r=n("p",null,"php session.upload_progress 通用利用脚本 https://www.nssctf.cn/note/set/2588",-1);function d(v,b){const a=p("ExternalLinkIcon");return e(),o("div",null,[u,n("p",null,[s("具体参考 "),n("a",k,[s("[第五空间 2021]EasyCleanup_ph0ebus 的博客-CSDN 博客"),l(a)])]),r])}const m=t(i,[["render",d],["__file","EasyCleanup.html.vue"]]);export{m as default};
